# рџ”§ Insomnia: РќР°СЃС‚СЂРѕР№РєР° РїРµСЂРµРјРµРЅРЅС‹С… РѕРєСЂСѓР¶РµРЅРёСЏ

## рџ“‹ РџРѕС€Р°РіРѕРІР°СЏ РёРЅСЃС‚СЂСѓРєС†РёСЏ

### РЁР°Рі 1: РћС‚РєСЂС‹С‚СЊ Environment Manager

РџРѕСЃР»Рµ РёРјРїРѕСЂС‚Р° РєРѕР»Р»РµРєС†РёРё:
1. Р’ Р»РµРІРѕРј РІРµСЂС…РЅРµРј СѓРіР»Сѓ Insomnia РЅР°Р№РґРёС‚Рµ РІС‹РїР°РґР°СЋС‰РёР№ СЃРїРёСЃРѕРє **"No Environment"** РёР»Рё **"Base Environment"**
2. РљР»РёРєРЅРёС‚Рµ РЅР° РЅРµРіРѕ
3. Р’С‹Р±РµСЂРёС‚Рµ **"Manage Environments"** (РёР»Рё РєР»РёРєРЅРёС‚Рµ РЅР° РёРєРѕРЅРєСѓ С€РµСЃС‚РµСЂРµРЅРєРё вљ™пёЏ)

---

### РЁР°Рі 2: РќР°СЃС‚СЂРѕРёС‚СЊ Base Environment

Р’С‹ СѓРІРёРґРёС‚Рµ РѕРєРЅРѕ СЃ JSON РїРµСЂРµРјРµРЅРЅС‹С…. Р”РѕР»Р¶РЅРѕ Р±С‹С‚СЊ С‚Р°Рє:

```json
{
  "base_url": "http://localhost:3000",
  "user_token": "",
  "moderator_token": "",
  "new_beam_id": "",
  "draft_id": "",
  "formed_id": "",
  "new_user_token": ""
}
```

**Р’РђР–РќРћ:** РџРѕРєР° РѕСЃС‚Р°РІСЊС‚Рµ РїСѓСЃС‚С‹Рµ СЃС‚СЂРѕРєРё - Р·Р°РїРѕР»РЅРёРј РёС… РїРѕСЃР»Рµ РІС‹РїРѕР»РЅРµРЅРёСЏ Р·Р°РїСЂРѕСЃРѕРІ.

---

## рџ”‘ РљРѕРіРґР° Рё РєР°Рє РѕР±РЅРѕРІР»СЏС‚СЊ С‚РѕРєРµРЅС‹

### Р—Р°РїСЂРѕСЃ #17: POST Sign In (User)

**1. Р’С‹РїРѕР»РЅРёС‚Рµ Р·Р°РїСЂРѕСЃ:**
```
POST http://localhost:3000/api/auth/sign_in
Body:
{
  "email": "user@demo.com",
  "password": "password123"
}
```

**2. Р’ РѕС‚РІРµС‚Рµ РїРѕР»СѓС‡РёС‚Рµ:**
```json
{
  "token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjozOSwiZXhwIjoxNzY0NTI5NTUwfQ.h61r9z0Rud3pyUVrYoNrO88wr-xf6Vq8Z8iJN1FFQV4",
  "user": {
    "id": 39,
    "email": "user@demo.com",
    "moderator": false
  }
}
```

**3. РЎРєРѕРїРёСЂСѓР№С‚Рµ Р·РЅР°С‡РµРЅРёРµ `token`:**
- Р’С‹РґРµР»РёС‚Рµ РІРµСЃСЊ С‚РѕРєРµРЅ (РЅР°С‡РёРЅР°РµС‚СЃСЏ СЃ `eyJ...`)
- Ctrl+C РґР»СЏ РєРѕРїРёСЂРѕРІР°РЅРёСЏ

**4. РћС‚РєСЂРѕР№С‚Рµ Environment Manager:**
- РљР»РёРєРЅРёС‚Рµ РЅР° РІС‹РїР°РґР°СЋС‰РёР№ СЃРїРёСЃРѕРє РІРІРµСЂС…Сѓ
- Manage Environments

**5. Р’СЃС‚Р°РІСЊС‚Рµ С‚РѕРєРµРЅ РІ `user_token`:**
```json
{
  "base_url": "http://localhost:3000",
  "user_token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjozOSwiZXhwIjoxNzY0NTI5NTUwfQ.h61r9z0Rud3pyUVrYoNrO88wr-xf6Vq8Z8iJN1FFQV4",
  "moderator_token": "",
  ...
}
```

**6. РќР°Р¶РјРёС‚Рµ "Done" РґР»СЏ СЃРѕС…СЂР°РЅРµРЅРёСЏ**

---

### Р—Р°РїСЂРѕСЃ #18: POST Sign In (Moderator)

**1. Р’С‹РїРѕР»РЅРёС‚Рµ Р·Р°РїСЂРѕСЃ:**
```
POST http://localhost:3000/api/auth/sign_in
Body:
{
  "email": "moderator@demo.com",
  "password": "password123"
}
```

**2. Р’ РѕС‚РІРµС‚Рµ РїРѕР»СѓС‡РёС‚Рµ:**
```json
{
  "token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0MCwiZXhwIjoxNzY0NTI5NTUwfQ.74Ud9dJZ1pPFzydT-yMWA-o5eqH0nOYmNlKiVtZJLl0",
  "user": {
    "id": 40,
    "email": "moderator@demo.com",
    "moderator": true
  }
}
```

**3. РЎРєРѕРїРёСЂСѓР№С‚Рµ С‚РѕРєРµРЅ Рё РІСЃС‚Р°РІСЊС‚Рµ РІ `moderator_token`:**
```json
{
  "base_url": "http://localhost:3000",
  "user_token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjozOSwiZXhwIjoxNzY0NTI5NTUwfQ.h61r9z0Rud3pyUVrYoNrO88wr-xf6Vq8Z8iJN1FFQV4",
  "moderator_token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0MCwiZXhwIjoxNzY0NTI5NTUwfQ.74Ud9dJZ1pPFzydT-yMWA-o5eqH0nOYmNlKiVtZJLl0",
  ...
}
```

---

### Р—Р°РїСЂРѕСЃ #5: POST Create Beam

**1. Р’С‹РїРѕР»РЅРёС‚Рµ Р·Р°РїСЂРѕСЃ** (РѕС‚ РёРјРµРЅРё РјРѕРґРµСЂР°С‚РѕСЂР°)

**2. Р’ РѕС‚РІРµС‚Рµ РїРѕР»СѓС‡РёС‚Рµ:**
```json
{
  "id": 45,
  "name": "Test Beam Demo",
  "material": "steel",
  ...
}
```

**3. РЎРєРѕРїРёСЂСѓР№С‚Рµ `id` Рё РІСЃС‚Р°РІСЊС‚Рµ РІ `new_beam_id`:**
```json
{
  ...
  "new_beam_id": "45",
  ...
}
```

**Р’РђР–РќРћ:** ID РєР°Рє СЃС‚СЂРѕРєР° (РІ РєР°РІС‹С‡РєР°С…) РёР»Рё С‡РёСЃР»Рѕ (Р±РµР· РєР°РІС‹С‡РµРє) - РѕР±Р° РІР°СЂРёР°РЅС‚Р° СЂР°Р±РѕС‚Р°СЋС‚.

---

### Р—Р°РїСЂРѕСЃ #9: GET Cart Badge

**1. Р’С‹РїРѕР»РЅРёС‚Рµ Р·Р°РїСЂРѕСЃ** (РїРѕСЃР»Рµ РґРѕР±Р°РІР»РµРЅРёСЏ СѓСЃР»СѓРі)

**2. Р’ РѕС‚РІРµС‚Рµ РїРѕР»СѓС‡РёС‚Рµ:**
```json
{
  "beam_deflection_id": 53,
  "items_count": 5
}
```

**3. РЎРєРѕРїРёСЂСѓР№С‚Рµ `beam_deflection_id` РІ `draft_id`:**
```json
{
  ...
  "draft_id": "53",
  ...
}
```

---

### Р—Р°РїСЂРѕСЃ #16: POST Sign Up (РЅРѕРІС‹Р№ РїРѕР»СЊР·РѕРІР°С‚РµР»СЊ)

**1. Р’ РѕС‚РІРµС‚Рµ РїРѕР»СѓС‡РёС‚Рµ:**
```json
{
  "token": "eyJhbGciOiJIUzI1NiJ9...",
  "user": {
    "id": 41,
    "email": "newuser@test.com",
    "moderator": false
  }
}
```

**2. РЎРєРѕРїРёСЂСѓР№С‚Рµ С‚РѕРєРµРЅ РІ `new_user_token`** (РѕРїС†РёРѕРЅР°Р»СЊРЅРѕ, РґР»СЏ РґР°Р»СЊРЅРµР№С€РµРіРѕ РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ)

---

## рџ“Љ РС‚РѕРіРѕРІС‹Рµ РїРµСЂРµРјРµРЅРЅС‹Рµ РѕРєСЂСѓР¶РµРЅРёСЏ

РџРѕСЃР»Рµ РІС‹РїРѕР»РЅРµРЅРёСЏ РІСЃРµС… Р·Р°РїСЂРѕСЃРѕРІ Сѓ РІР°СЃ РґРѕР»Р¶РЅРѕ РїРѕР»СѓС‡РёС‚СЊСЃСЏ:

```json
{
  "base_url": "http://localhost:3000",
  "user_token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjozOSwiZXhwIjoxNzY0NTI5NTUwfQ.h61r9z0Rud3pyUVrYoNrO88wr-xf6Vq8Z8iJN1FFQV4",
  "moderator_token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0MCwiZXhwIjoxNzY0NTI5NTUwfQ.74Ud9dJZ1pPFzydT-yMWA-o5eqH0nOYmNlKiVtZJLl0",
  "new_beam_id": "45",
  "draft_id": "53",
  "formed_id": "52",
  "new_user_token": "eyJhbGciOiJIUzI1NiJ9..."
}
```

---

## рџЋЇ РљР°Рє РёСЃРїРѕР»СЊР·СѓСЋС‚СЃСЏ РїРµСЂРµРјРµРЅРЅС‹Рµ РІ Р·Р°РїСЂРѕСЃР°С…

### РџСЂРёРјРµСЂ 1: Authorization Header
```
Authorization: Bearer {{ _.user_token }}
```
Insomnia Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё РїРѕРґСЃС‚Р°РІРёС‚ Р·РЅР°С‡РµРЅРёРµ РёР· `user_token`.

### РџСЂРёРјРµСЂ 2: URL СЃ РїР°СЂР°РјРµС‚СЂРѕРј
```
GET http://{{ _.base_url }}/api/beams/{{ _.new_beam_id }}
```
РџСЂРµРІСЂР°С‚РёС‚СЃСЏ РІ:
```
GET http://localhost:3000/api/beams/45
```

### РџСЂРёРјРµСЂ 3: Body СЃ РїРµСЂРµРјРµРЅРЅРѕР№
```json
{
  "beam_id": {{ _.new_beam_id }}
}
```

---

## рџ”„ Р‘С‹СЃС‚СЂС‹Р№ СЃРїРѕСЃРѕР± РєРѕРїРёСЂРѕРІР°РЅРёСЏ

### Р§РµСЂРµР· РєРѕРЅС‚РµРєСЃС‚РЅРѕРµ РјРµРЅСЋ:
1. Р’ РѕС‚РІРµС‚Рµ РєР»РёРєРЅРёС‚Рµ РїСЂР°РІРѕР№ РєРЅРѕРїРєРѕР№ РЅР° Р·РЅР°С‡РµРЅРёРµ (РЅР°РїСЂРёРјРµСЂ, РЅР° С‚РѕРєРµРЅ)
2. Р’С‹Р±РµСЂРёС‚Рµ **"Copy Value"**
3. РћС‚РєСЂРѕР№С‚Рµ Environment Manager
4. Р’СЃС‚Р°РІСЊС‚Рµ (Ctrl+V) РІ РЅСѓР¶РЅСѓСЋ РїРµСЂРµРјРµРЅРЅСѓСЋ

### Р§РµСЂРµР· РїРѕРёСЃРє:
1. Р’ РѕС‚РІРµС‚Рµ РёСЃРїРѕР»СЊР·СѓР№С‚Рµ РїРѕРёСЃРє (Ctrl+F)
2. РќР°Р№РґРёС‚Рµ РЅСѓР¶РЅРѕРµ РїРѕР»Рµ (`token`, `id`)
3. РЎРєРѕРїРёСЂСѓР№С‚Рµ Р·РЅР°С‡РµРЅРёРµ
4. Р’СЃС‚Р°РІСЊС‚Рµ РІ Environment

---

## вљ пёЏ Р’Р°Р¶РЅС‹Рµ РјРѕРјРµРЅС‚С‹

### 1. РџРѕСЂСЏРґРѕРє РІС‹РїРѕР»РЅРµРЅРёСЏ
**РћР‘РЇР—РђРўР•Р›Р¬РќРћ СЃРЅР°С‡Р°Р»Р° РІС‹РїРѕР»РЅРёС‚Рµ #17 Рё #18** (sign in), С‡С‚РѕР±С‹ РїРѕР»СѓС‡РёС‚СЊ С‚РѕРєРµРЅС‹. Р‘РµР· С‚РѕРєРµРЅРѕРІ РѕСЃС‚Р°Р»СЊРЅС‹Рµ Р·Р°РїСЂРѕСЃС‹ РІРµСЂРЅСѓС‚ 401 Unauthorized.

### 2. РЎСЂРѕРє РґРµР№СЃС‚РІРёСЏ С‚РѕРєРµРЅРѕРІ
РўРѕРєРµРЅС‹ РґРµР№СЃС‚РІРёС‚РµР»СЊРЅС‹ **24 С‡Р°СЃР°** (СЃРј. utilities/docs/PROJECT_SNAPSHOT.md - С‚Р°Рј С‚РѕРєРµРЅС‹ РґРѕ 2025-12-29).

Р•СЃР»Рё С‚РѕРєРµРЅ РёСЃС‚РµРє:
- Р’С‹РїРѕР»РЅРёС‚Рµ СЃРЅРѕРІР° Р·Р°РїСЂРѕСЃ #17 РёР»Рё #18
- РћР±РЅРѕРІРёС‚Рµ РїРµСЂРµРјРµРЅРЅСѓСЋ РѕРєСЂСѓР¶РµРЅРёСЏ РЅРѕРІС‹Рј С‚РѕРєРµРЅРѕРј

### 3. РџРѕСЃР»Рµ sign_out
РџРѕСЃР»Рµ Р·Р°РїСЂРѕСЃР° #21 (Sign Out) С‚РѕРєРµРЅ РґРѕР±Р°РІР»СЏРµС‚СЃСЏ РІ blacklist.

**РќСѓР¶РЅРѕ СЃРЅРѕРІР°:**
1. Р’С‹РїРѕР»РЅРёС‚СЊ #17 РёР»Рё #18
2. РџРѕР»СѓС‡РёС‚СЊ РЅРѕРІС‹Р№ С‚РѕРєРµРЅ
3. РћР±РЅРѕРІРёС‚СЊ РїРµСЂРµРјРµРЅРЅСѓСЋ РѕРєСЂСѓР¶РµРЅРёСЏ

### 4. Docker РїРµСЂРµР·Р°РїСѓСЃРє
Р•СЃР»Рё РІС‹ РїРµСЂРµР·Р°РїСѓСЃС‚РёР»Рё Docker (Рё РїРµСЂРµСЃРѕР·РґР°Р»Рё Р±Р°Р·Сѓ), ID РѕР±СЉРµРєС‚РѕРІ РёР·РјРµРЅСЏС‚СЃСЏ.

**РќСѓР¶РЅРѕ РѕР±РЅРѕРІРёС‚СЊ:**
- `new_beam_id` - РїРѕСЃР»Рµ СЃРѕР·РґР°РЅРёСЏ РЅРѕРІРѕР№ Р±Р°Р»РєРё
- `draft_id` - РїРѕСЃР»Рµ РїРѕР»СѓС‡РµРЅРёСЏ cart_badge
- Р’РѕР·РјРѕР¶РЅРѕ, `user_token` Рё `moderator_token` (РµСЃР»Рё РїРѕР»СЊР·РѕРІР°С‚РµР»Рё РїРµСЂРµСЃРѕР·РґР°РЅС‹)

---

## рџљЂ Р‘С‹СЃС‚СЂС‹Р№ СЃС‚Р°СЂС‚ (TL;DR)

### РЁР°Рі 1: РРјРїРѕСЂС‚РёСЂСѓР№С‚Рµ РєРѕР»Р»РµРєС†РёСЋ
```
Insomnia в†’ Import в†’ Insomnia_Collection_DEMO.json
```

### РЁР°Рі 2: Р’С‹РїРѕР»РЅРёС‚Рµ sign in Р·Р°РїСЂРѕСЃС‹
1. **Р—Р°РїСЂРѕСЃ #17** в†’ РЎРєРѕРїРёСЂСѓР№С‚Рµ `token` в†’ Р’СЃС‚Р°РІСЊС‚Рµ РІ `user_token`
2. **Р—Р°РїСЂРѕСЃ #18** в†’ РЎРєРѕРїРёСЂСѓР№С‚Рµ `token` в†’ Р’СЃС‚Р°РІСЊС‚Рµ РІ `moderator_token`

### РЁР°Рі 3: Р’С‹РїРѕР»РЅСЏР№С‚Рµ РѕСЃС‚Р°Р»СЊРЅС‹Рµ Р·Р°РїСЂРѕСЃС‹ РїРѕ РїРѕСЂСЏРґРєСѓ
РџСЂРё РЅРµРѕР±С…РѕРґРёРјРѕСЃС‚Рё РѕР±РЅРѕРІР»СЏР№С‚Рµ:
- `new_beam_id` РїРѕСЃР»Рµ Р·Р°РїСЂРѕСЃР° #5
- `draft_id` РїРѕСЃР»Рµ Р·Р°РїСЂРѕСЃР° #9

### РЁР°Рі 4: РџСЂРѕРІРµСЂСЊС‚Рµ СЂРµР·СѓР»СЊС‚Р°С‚С‹
Р§РµСЂРµР· Rails console РёР»Рё СЃР»РµРґСѓСЋС‰РёРµ Р·Р°РїСЂРѕСЃС‹ РІ РєРѕР»Р»РµРєС†РёРё.

---

## рџ’Ў РђР»СЊС‚РµСЂРЅР°С‚РёРІР°: Pre-filled С‚РѕРєРµРЅС‹

Р•СЃР»Рё РІС‹ СѓР¶Рµ СЃРѕР·РґР°Р»Рё РґРµРјРѕ-РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№ С‡РµСЂРµР· `utilities/scripts/prepare_demo.rb`, РјРѕР¶РµС‚Рµ СЃСЂР°Р·Сѓ РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ РіРѕС‚РѕРІС‹Рµ С‚РѕРєРµРЅС‹ РёР· utilities/docs/PROJECT_SNAPSHOT.md:

```json
{
  "base_url": "http://localhost:3000",
  "user_token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjozOSwiZXhwIjoxNzY0NTI5NTUwfQ.h61r9z0Rud3pyUVrYoNrO88wr-xf6Vq8Z8iJN1FFQV4",
  "moderator_token": "eyJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjo0MCwiZXhwIjoxNzY0NTI5NTUwfQ.74Ud9dJZ1pPFzydT-yMWA-o5eqH0nOYmNlKiVtZJLl0",
  "new_beam_id": "39",
  "draft_id": "51",
  "formed_id": "52"
}
```

**РќРѕ:** Р­С‚Рё С‚РѕРєРµРЅС‹ РґРµР№СЃС‚РІРёС‚РµР»СЊРЅС‹ С‚РѕР»СЊРєРѕ РґРѕ **2025-12-29**!

---

## рџЋ¬ Р’РёРґРµРѕ-РёРЅСЃС‚СЂСѓРєС†РёСЏ (С‚РµРєСЃС‚РѕРІР°СЏ РІРµСЂСЃРёСЏ)

### РњРёРЅСѓС‚Р° 1: РРјРїРѕСЂС‚
- РћС‚РєСЂС‹РІР°РµРј Insomnia
- Import/Export в†’ Import Data в†’ From File
- Р’С‹Р±РёСЂР°РµРј Insomnia_Collection_DEMO.json
- Р’РёРґРёРј 21 Р·Р°РїСЂРѕСЃ + EXTRA

### РњРёРЅСѓС‚Р° 2: Environment
- РљР»РёРєР°РµРј РЅР° РІС‹РїР°РґР°СЋС‰РёР№ СЃРїРёСЃРѕРє РІРІРµСЂС…Сѓ
- Manage Environments
- Р’РёРґРёРј РїСѓСЃС‚С‹Рµ РїРµСЂРµРјРµРЅРЅС‹Рµ
- РџРѕРєР° РЅРµ С‚СЂРѕРіР°РµРј, Р·Р°РєСЂС‹РІР°РµРј

### РњРёРЅСѓС‚Р° 3: Sign In User
- Р’С‹Р±РёСЂР°РµРј Р·Р°РїСЂРѕСЃ "17. POST Sign In (User)"
- РќР°Р¶РёРјР°РµРј Send
- Р’ РѕС‚РІРµС‚Рµ РІРёРґРёРј `"token": "eyJ..."`
- РљРѕРїРёСЂСѓРµРј РІРµСЃСЊ С‚РѕРєРµРЅ (Ctrl+C)

### РњРёРЅСѓС‚Р° 4: РћР±РЅРѕРІР»СЏРµРј РїРµСЂРµРјРµРЅРЅСѓСЋ
- РћС‚РєСЂС‹РІР°РµРј Manage Environments
- РќР°С…РѕРґРёРј `"user_token": ""`
- Р’СЃС‚Р°РІР»СЏРµРј С‚РѕРєРµРЅ РјРµР¶РґСѓ РєР°РІС‹С‡РµРє
- РќР°Р¶РёРјР°РµРј Done

### РњРёРЅСѓС‚Р° 5: Sign In Moderator
- Р’С‹Р±РёСЂР°РµРј Р·Р°РїСЂРѕСЃ "18. POST Sign In (Moderator)"
- Send в†’ РљРѕРїРёСЂСѓРµРј С‚РѕРєРµРЅ в†’ Р’СЃС‚Р°РІР»СЏРµРј РІ `moderator_token`

### РњРёРЅСѓС‚Р° 6: Р“РѕС‚РѕРІРѕ!
- РўРµРїРµСЂСЊ РІСЃРµ РѕСЃС‚Р°Р»СЊРЅС‹Рµ Р·Р°РїСЂРѕСЃС‹ Р±СѓРґСѓС‚ Р°РІС‚РѕРјР°С‚РёС‡РµСЃРєРё РёСЃРїРѕР»СЊР·РѕРІР°С‚СЊ С‚РѕРєРµРЅС‹
- Р’С‹РїРѕР»РЅСЏРµРј РїРѕ РїРѕСЂСЏРґРєСѓ РѕС‚ 01 РґРѕ 21

---

**Р“РѕС‚РѕРІРѕ!** РўРµРїРµСЂСЊ РІС‹ Р·РЅР°РµС‚Рµ, РєР°Рє РѕР±РЅРѕРІР»СЏС‚СЊ РїРµСЂРµРјРµРЅРЅС‹Рµ РѕРєСЂСѓР¶РµРЅРёСЏ РІ Insomnia. рџЋ‰


