# –ü–æ–ª–Ω—ã–π Workflow: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ —á–µ—Ä–µ–∑ API

## üéØ –¶–µ–ª—å
–°–æ–∑–¥–∞—Ç—å beam_deflection (–∑–∞—è–≤–∫—É) —á–µ—Ä–µ–∑ Swagger UI –∏ –ø–æ–ª—É—á–∏—Ç—å –µ—ë –≤ —Å–ø–∏—Å–∫–µ.

---

## –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è / –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç A: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
**POST /api/auth/sign_up**
```json
{
  "email": "test_workflow@example.com",
  "password": "password123",
  "password_confirmation": "password123"
}
```

### –í–∞—Ä–∏–∞–Ω—Ç B: Demo –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–∏–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)
**POST /api/auth/sign_in**
```json
{
  "email": "demo@local",
  "password": "password"
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `token` –∏–∑ –æ—Ç–≤–µ—Ç–∞

---

## –®–∞–≥ 2: Authorize –≤ Swagger

1. –ù–∞–∂–º–∏—Ç–µ üîì **Authorize**
2. –í—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω (–ë–ï–ó "Bearer")
3. Authorize ‚Üí Close

---

## –®–∞–≥ 3: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–∞–ª–æ–∫

**GET /api/beams**

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `id` –æ–¥–Ω–æ–π –∏–∑ –±–∞–ª–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1`)

---

## –®–∞–≥ 4: –î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–∫—É –≤ —á–µ—Ä–Ω–æ–≤–∏–∫

**POST /api/beam_deflection_beams**
```json
{
  "beam_id": 1,
  "quantity": 2
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ë–∞–ª–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –≤–∞—à draft

---

## –®–∞–≥ 5: –ü–æ–ª—É—á–∏—Ç—å ID —Ç–µ–∫—É—â–µ–≥–æ —á–µ—Ä–Ω–æ–≤–∏–∫–∞

**GET /api/beam_deflections/cart_badge**

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
```json
{
  "beam_deflection_id": 25,  // ‚Üê –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç ID
  "items_count": 2
}
```

---

## –®–∞–≥ 6: –û–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞—è–≤–∫–∏

**PUT /api/beam_deflections/{draft_id}**

–ó–∞–º–µ–Ω–∏—Ç–µ `{draft_id}` –Ω–∞ ID –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞.

```json
{
  "beam_deflection": {
    "length_m": 5.0,
    "udl_kn_m": 10.0,
    "note": "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞—è–≤–∫–∞ —á–µ—Ä–µ–∑ API"
  }
}
```

---

## –®–∞–≥ 7: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é

**PUT /api/beam_deflections/{draft_id}/form**

–ó–∞–º–µ–Ω–∏—Ç–µ `{draft_id}` –Ω–∞ –≤–∞—à ID.

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ó–∞—è–≤–∫–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –≤ —Å—Ç–∞—Ç—É—Å `formed`

---

## –®–∞–≥ 8: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫

**GET /api/beam_deflections**

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ!
```json
{
  "beam_deflections": [
    {
      "id": 25,
      "status": "formed",
      "length_m": 5.0,
      "udl_kn_m": 10.0,
      "note": "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞—è–≤–∫–∞ —á–µ—Ä–µ–∑ API",
      "creator_login": "test_workflow@example.com",
      ...
    }
  ],
  "meta": {
    "current_page": 1,
    "total_count": 1
  }
}
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
**GET /api/beam_deflections?status=formed**

### –î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏
**GET /api/beam_deflections/{id}**

### –ü–∞–≥–∏–Ω–∞—Ü–∏—è
**GET /api/beam_deflections?page=1&per_page=10**

---

## üîê –î–ª—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –æ–¥–æ–±—Ä–∏—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É, –Ω—É–∂–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å `moderator: true`.

**–°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞** (—á–µ—Ä–µ–∑ Rails console –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç):
```ruby
User.create!(
  email: "moderator@example.com",
  password: "password123",
  password_confirmation: "password123",
  moderator: true
)
```

–ó–∞—Ç–µ–º –≤ Swagger:
- **POST /api/auth/sign_in** –∫–∞–∫ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä
- **PUT /api/beam_deflections/{id}/complete** - –æ–¥–æ–±—Ä–∏—Ç—å
- **PUT /api/beam_deflections/{id}/reject** - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å

---

## üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞—è–≤–æ–∫

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –í–∏–¥–Ω–æ –≤ GET /api/beam_deflections |
|--------|----------|-----------------------------------|
| `draft` | –ß–µ—Ä–Ω–æ–≤–∏–∫ | ‚ùå –ù–µ—Ç (–∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è) |
| `formed` | –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ | ‚úÖ –î–∞ |
| `completed` | –û–¥–æ–±—Ä–µ–Ω–æ | ‚úÖ –î–∞ |
| `rejected` | –û—Ç–∫–ª–æ–Ω–µ–Ω–æ | ‚úÖ –î–∞ |
| `deleted` | –£–¥–∞–ª–µ–Ω–æ | ‚ùå –ù–µ—Ç (–∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è) |

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:
- ‚úÖ –°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞—è–≤–∫–∏ —á–µ—Ä–µ–∑ API
- ‚úÖ –ü–æ–ª—É—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ GET /api/beam_deflections
- ‚úÖ –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å–∞–º–∏ (–µ—Å–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä)
